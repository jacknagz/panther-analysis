AnalysisType: rule
Enabled: true
RuleID: "Panther.MultipleDetectionsDeletedHigh.Demo"
LogTypes:
  - Panther.Audit
Severity: High
CreateAlert: true
DisplayName: Multiple Detections Deleted in Short Period
Description: Detects when multiple detections (rules, policies, scheduled rules) are deleted in a short period, which may indicate malicious insider activity or sabotage.
Detection:
  - KeyPath: actionName
    Condition: Equals
    Value: DELETE_DETECTION
  - KeyPath: actionResult
    Condition: Equals
    Value: SUCCEEDED
GroupBy:
  - KeyPath: actor.id
DedupPeriodMinutes: 60
Threshold: 5
Tags:
  - demo
  - mitre.ta0005.defense_evasion
  - mitre.ta0040.impact
  - mitre.t1562.impair_defenses
  - usecase.insider_threat_detection
  - usecase.siem_integrity
  - asset.detection_controls
  - threat.insider
  - impact.availability
  - risk.high
Reports:
  MITRE ATT&CK:
    - TA0040:T1562
    - TA0005:T1485
Reference: https://docs.panther.com/system-configuration/panther-audit-logs
Runbook: |
  1. Review the actor's recent activity for additional destructive or suspicious actions.
  2. Confirm if the deletions were authorized and documented.
  3. If unauthorized, immediately disable the user's access and begin incident response.
Tests:
  - Name: Multiple detections deleted by same user (should alert)
    ExpectedResult: true
    Log:
      actionName: DELETE_DETECTION
      actionResult: SUCCEEDED
      actor:
        id: user-123
        name: attacker@evil.com
        attributes:
          email: attacker@evil.com
      timestamp: "2025-06-23T10:00:00Z"
