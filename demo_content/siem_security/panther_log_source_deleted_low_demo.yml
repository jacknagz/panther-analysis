AnalysisType: rule
RuleID: "Panther.LogSource.Deleted.Low.Demo"
DisplayName: Log Source Deleted - Tracking
Enabled: true
Filename: panther_log_source_deleted_low_demo.py
LogTypes:
  - Panther.Audit
Severity: Low
CreateAlert: true
Description: >
  Tracks when log sources are deleted in Panther SIEM platform for operational visibility and security monitoring.
  Log source deletion can indicate legitimate administrative activities, defense evasion attempts to reduce 
  security visibility, or evidence destruction efforts. This low-severity rule provides comprehensive tracking
  without generating high-priority alerts, suitable for security operations teams to monitor data pipeline changes
  and maintain awareness of logging infrastructure modifications.
DedupPeriodMinutes: 60
Tags:
  - demo
  - compliance.change_management
  - mitre.ta0005.defense_evasion
  - mitre.t1562.impair_defenses  
  - usecase.siem_integrity
  - usecase.operational_monitoring
  - asset.logging_infrastructure
  - threat.insider
  - impact.availability
  - risk.low
Reports:
  MITRE ATT&CK:
    - TA0005:T1562  # Defense Evasion: Impair Defenses
    - TA0040:T1562  # Impact: Impair Defenses
Reference: https://docs.panther.com/system-configuration/panther-audit-logs
Runbook: |
  This is a low-severity tracking alert for log source deletions. Investigation steps:
  
  1. **Check Context**: Review recent activity by the same actor for patterns of infrastructure changes
  2. **Impact Assessment**: Determine which log types and data sources are no longer being ingested
  3. **Correlation Analysis**: Look for related administrative actions around the same timeframe
  4. **Documentation**: Update internal documentation to reflect logging infrastructure changes
  
  **Escalation Criteria**: Escalate if:
  - Multiple log sources deleted in short timeframe
  - Deletion performed by unauthorized user
  - Deletion coincides with other suspicious administrative activities
  - Critical log sources (CloudTrail, security tools) are affected
SummaryAttributes:
  - actor.name
  - actor.attributes.email
  - sourceIP
  - actionParams.dynamic.input.name
Tests:
  - Name: Log source deleted successfully (should alert)
    ExpectedResult: true
    Log:
      p_log_type: Panther.Audit
      p_event_time: "2024-03-15T14:30:00Z"
      actionName: DELETE_LOG_SOURCE
      actionResult: SUCCEEDED
      actor:
        id: "PantherSSO_admin.user@company.com"
        type: USER
        name: "admin.user@company.com"
        attributes:
          email: "admin.user@company.com"
          roleName: "Admin"
      sourceIP: "203.0.113.100"
      userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"
      timestamp: "2024-03-15T14:30:00Z"
      pantherVersion: "1.113.130"
      actionParams:
        dynamic:
          input:
            logSourceId: "log-source-abc123"
            name: "AWS CloudTrail - Production"
            integrationType: "aws-s3"
            logTypes: ["AWS.CloudTrail"]
  - Name: Log source deletion failed (should not alert)
    ExpectedResult: false
    Log:
      p_log_type: Panther.Audit
      p_event_time: "2024-03-15T14:31:00Z"
      actionName: DELETE_LOG_SOURCE
      actionResult: FAILED
      actor:
        id: "PantherSSO_user.test@company.com"
        type: USER
        name: "user.test@company.com"
        attributes:
          email: "user.test@company.com"
          roleName: "Analyst"
      sourceIP: "203.0.113.101"
      userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"
      timestamp: "2024-03-15T14:31:00Z"
      pantherVersion: "1.113.130"
      actionParams:
        dynamic:
          input:
            logSourceId: "log-source-def456"
            name: "AWS VPC Flow Logs"
            integrationType: "aws-s3"
            logTypes: ["AWS.VPCFlow"]
  - Name: Log source created (should not alert)
    ExpectedResult: false
    Log:
      p_log_type: Panther.Audit
      p_event_time: "2024-03-15T14:32:00Z"
      actionName: CREATE_LOG_SOURCE
      actionResult: SUCCEEDED
      actor:
        id: "PantherSSO_ops.user@company.com"
        type: USER
        name: "ops.user@company.com"
        attributes:
          email: "ops.user@company.com"
          roleName: "AnalystAdmin"
      sourceIP: "203.0.113.102"
      userAgent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
      timestamp: "2024-03-15T14:32:00Z"
      pantherVersion: "1.113.130"
      actionParams:
        dynamic:
          input:
            name: "New Application Logs"
            integrationType: "http-ingest"
            logTypes: ["Custom.Application"]
  - Name: Different action name (should not alert)
    ExpectedResult: false
    Log:
      p_log_type: Panther.Audit
      p_event_time: "2024-03-15T14:33:00Z"
      actionName: UPDATE_LOG_SOURCE
      actionResult: SUCCEEDED
      actor:
        id: "PantherSSO_admin.user@company.com"
        type: USER
        name: "admin.user@company.com"
        attributes:
          email: "admin.user@company.com"
          roleName: "Admin"
      sourceIP: "203.0.113.100"
      userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"
      timestamp: "2024-03-15T14:33:00Z"
      pantherVersion: "1.113.130"